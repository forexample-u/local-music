<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Music</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: #121212;
            color: #fff;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        .sidebar {
            width: 80px;
            background-color: #000;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            color: #1db954;
            margin-bottom: 40px;
        }
        
        .nav-item {
            width: 100%;
            padding: 16px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .nav-item:hover {
            background-color: #1a1a1a;
        }
        
        .nav-item.active {
            background-color: #282828;
            border-left: 3px solid #1db954;
        }
        
        .nav-icon {
            font-size: 22px;
            color: #b3b3b3;
        }
        
        .nav-item.active .nav-icon {
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .playlist-container {
            flex: 1;
            overflow-y: auto;
        }
        
        .playlist-header {
            padding: 30px;
            background: linear-gradient(180deg, #2a5d3d 0%, #121212 100%);
            display: flex;
            align-items: center;
            gap: 24px;
        }
        
        .playlist-cover {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #450af5, #c4efd9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            flex-shrink: 0;
        }
        
        .playlist-info {
            flex: 1;
        }
        
        .playlist-type {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .playlist-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .playlist-description {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .playlist-stats {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #b3b3b3;
        }
        
        .playlist-actions {
            margin-top: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .play-btn {
            background-color: #1db954;
            color: #000;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
        }
        
        .like-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 28px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .like-btn:hover {
            color: #1db954;
        }
        
        .tracks-container {
            padding: 0 30px 20px;
            background-color: #121212;
        }
        
        .track-list {
            margin-top: 20px;
        }
        
        .track-row {
            display: flex;
            align-items: center;
            padding: 12px 0 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            gap: 20px;
        }
        
        .track-row:hover {
            background-color: #2a2a2a;
        }
        
        .track-info {
            position: relative;
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .track-play-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1;
            width: 50px;
            height: 20px;
        }

        .track-row:hover .track-play-icon {
            opacity: 1;
        }

        .track-row:hover .track-cover {
            opacity: 0.6;
        }
        
        .track-cover {
            width: 40px;
            height: 40px;
            background-color: #333;
            flex-shrink: 0;
        }
        
        .track-details {
            display: flex;
            flex-direction: column;
            min-width: 0;
            flex: 1;
        }
        
        .track-title {
            font-weight: 500;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .track-artist {
            color: #b3b3b3;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .track-time {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-left: auto;
            padding-right: 10px;
        }
        
        .track-duration {
            color: #b3b3b3;
            font-size: 14px;
            width: 45px;
            text-align: right;
        }
        
        .track-like {
            color: #b3b3b3;
            font-size: 18px;
            transition: color 0.2s;
            cursor: pointer;
            width: 30px;
            text-align: center;
        }
        
        .track-like:hover {
            color: #1db954;
        }
        
        .playing {
            background-color: rgba(29, 185, 84, 0.1);
        }
        
        .like-active {
            color: #1db954;
        }
        
        .player {
            position: fixed;
            bottom: 0;
            left: 80px;
            right: 0;
            height: 80px;
            background-color: #181818;
            border-top: 1px solid #282828;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
            flex-shrink: 0;
        }
        
        .player-track {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 300px;
        }
        
        .player-cover {
            width: 56px;
            height: 56px;
            background-color: #333;
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
        }
        
        .player-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
            cursor: pointer;
        }
        
        .player-artist {
            color: #b3b3b3;
            font-size: 12px;
            cursor: pointer;
        }
        
        .player-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            width: 65%;
        }
        
        .control-buttons {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .control-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 18px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .control-btn:hover {
            color: #fff;
        }
        
        .play-pause-btn {
            background-color: #fff;
            color: #000;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .play-pause-btn:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #4d4d4d;
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress {
            transition: width 0.1s linear;
            will-change: width;
            width: 0%;
            height: 100%;
            background-color: #1db954;
        }
        
        .player-time {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 12px;
            color: #b3b3b3;
        }
        
        .player-extra {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 300px;
            justify-content: flex-end;
        }
        
        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .volume-icon {
            color: #b3b3b3;
            font-size: 18px;
        }
        
        .volume-bar {
            width: 100px;
            height: 4px;
            background-color: #4d4d4d;
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .volume-level {
            width: 70%;
            height: 100%;
            background-color: #1db954;
        }

        #audioPlayer {
            display: none;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #121212;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #2a2a2a;
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #3a3a3a;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <a class="logo" href="">
            <i class="fas fa-music"></i>
        </a>
        <div class="nav-item active" id="menuHome">
            <div class="nav-icon">
                <i class="fas fa-home"></i>
            </div>
        </div>
        <div class="nav-item" id="menuSearch">
            <div class="nav-icon">
                <i class="fas fa-search"></i>
            </div>
        </div>
        <div class="nav-item" id="menuPlus">
            <div class="nav-icon">
                <i class="fas fa-plus"></i>
            </div>
        </div>
        <div class="nav-item" id="menuFavorite">
            <div class="nav-icon">
                <i class="fas fa-heart"></i>
            </div>
        </div>
    </div>
    <div class="main-content">
        <div class="playlist-container">
            <div class="playlist-header" id="playlistHeader">
                <div class="playlist-cover" id="playlistCover">
                    <i class="fas fa-headphones"></i>
                </div>
                <div class="playlist-info">
                    <div class="playlist-title" id="playlistTitle">Playlist Every Day</div>
                    <div class="playlist-description" id="playlistDescription" style="color: #fff">Every day belongs to you!</div>
                    <div class="playlist-stats">
                        <span>Service music</span>
                        <span>•</span>
                        <span>Playlist</span>
                        <span>•</span>
                        <span>Top</span>
                    </div>
                    <div class="playlist-actions">
                        <button class="play-btn" id="mainPlayBtn">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="like-btn">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="tracks-container">
                <div class="track-list" id="trackList"></div>
            </div>
        </div>
        <div class="player">
            <audio id="audioPlayer" preload="metadata">
                <source src="audio/test.mp3" type="audio/mpeg">
            </audio>
            <div class="player-track">
                <div class="player-cover" id="playerCover" style="background: linear-gradient(135deg, #ff9a9e, #fad0c4);"></div>
                <div class="player-info">
                    <div class="player-title" id="playerTitle">None</div>
                    <div class="player-artist" id="playerArtist">None</div>
                </div>
            </div>
            <div class="player-controls">
                <div class="control-buttons">
                    <div class="track-like like-active">
                        <i class="fas fa-heart"></i>
                    </div>
                    <button class="control-btn" id="prevTrackBtn">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="play-pause-btn" id="playPauseBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="control-btn" id="nextTrackBtn">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <button class="control-btn">
                        <i class="far fa-heart" style="position:relative;"><span style="position:absolute; top:50%; left:55%; transform:translate(-50%,-50%) rotate(40deg); width:25px; height:3px; background-color:#ddd; border-radius:1px;"></span></i>
                    </button>
                </div>
                <div class="player-time">
                    <span id="currentTimeEl">0:00</span>
                    <div class="progress-bar" id="progressBar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <span id="endTimeEl">0:00</span>
                </div>
            </div>
            <div class="player-extra">
                <div class="control-btn">
                    <i class="fas fa-list"></i>
                </div>
                <div class="volume-container">
                    <i class="fas fa-volume-up volume-icon"></i>
                    <div class="volume-bar" id="volumeBar">
                        <div class="volume-level" id="volumeLevel"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="audio/audio.js"></script>
    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseBtn = document.getElementById("playPauseBtn");
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const nextTrackBtn = document.getElementById("nextTrackBtn");
        const prevTrackBtn = document.getElementById("prevTrackBtn");
        const volumeBar = document.getElementById("volumeBar");
        const volumeLevel = document.getElementById("volumeLevel");
        const playerTitle = document.getElementById("playerTitle");
        const playerArtist = document.getElementById("playerArtist");
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTimeEl');
        const endTimeEl = document.getElementById('endTimeEl');
        const playerCover = document.getElementById('playerCover');
        const progressBar = document.getElementById('progressBar');
        const trackList = document.getElementById('trackList');
        const menuFavorite = document.getElementById('menuFavorite');
        const menuHome = document.getElementById('menuHome');
        const menuPlus = document.getElementById('menuPlus');
        const menuSearch = document.getElementById('menuSearch');
        const playlistHeader = document.getElementById('playlistHeader');
        const playlistTitle = document.getElementById('playlistTitle');
        const playlistDescription = document.getElementById('playlistDescription');
        const playlistCover = document.getElementById('playlistCover');

        function formatTime(seconds){
            const secs = Math.floor(seconds % 60);
            return `${Math.floor(seconds / 60)}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function stringToColor(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = str.charCodeAt(i) + ((hash << 5) - hash);
            }
            const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();
            return "#" + "00000".substring(0, 6 - c.length) + c;
        }

        progressBar.addEventListener('click', function(e) {
            const clickPosition = e.offsetX;
            const progressBarWidth = this.offsetWidth;
            const duration = audioPlayer.duration;
            if (duration && !isNaN(duration)) {
                audioPlayer.currentTime = (clickPosition / progressBarWidth) * duration;
                progress.style.width = `${(clickPosition / progressBarWidth) * 100}%`;
            }
        });

        menuFavorite.addEventListener('click', function() {
            menuFavorite.classList.add('active');
            menuHome.classList.remove('active');
            menuPlus.classList.remove('active');
            menuSearch.classList.remove('active');
            playlistHeader.style.background = "linear-gradient(180deg, #4c192c 0%, #121212 100%)";
            playlistTitle.innerHTML = "Favorite";
            playlistDescription.innerHTML = "Your favorite track";
            playlistCover.style.background = "linear-gradient(135deg, #e94057, #8a2387, #f27121)";
            playlistCover.innerHTML = '<i class="fas fa-heart"></i>';
            generateByPlaylist(playlistFavorite);
        });

        menuHome.addEventListener('click', function() {
            menuHome.classList.add('active');
            menuFavorite.classList.remove('active');
            menuPlus.classList.remove('active');
            menuSearch.classList.remove('active');
            playlistHeader.style.background = "linear-gradient(180deg, #2a5d3d 0%, #121212 100%)";
            playlistTitle.innerHTML = "Playlist Every Day";
            playlistDescription.innerHTML = "Every day belongs to you!";
            playlistCover.style.background = "";
            playlistCover.innerHTML = '<i class="fas fa-headphones"></i>';
            generateByPlaylist(playlistTodayDay);
        });

        menuSearch.addEventListener('click', function() {
            menuSearch.classList.add('active');
            menuHome.classList.remove('active');
            menuFavorite.classList.remove('active');
            menuPlus.classList.remove('active');
        });

        menuPlus.addEventListener('click', function() {
            menuPlus.classList.add('active');
            menuHome.classList.remove('active');
            menuFavorite.classList.remove('active');
            menuSearch.classList.remove('active');
        });

        volumeBar.addEventListener('click', function(e) {
            const clickPosition = e.offsetX;
            const volumeBarWidth = this.offsetWidth;
            const newVolume = clickPosition / volumeBarWidth;
            audioPlayer.volume = newVolume;
            volumeLevel.style.width = `${newVolume * 100}%`;
            const volumeIcon = document.querySelector('.volume-icon');
            if (newVolume === 0) { volumeIcon.className = 'fas fa-volume-mute volume-icon'; }
            else { volumeIcon.className = 'fas fa-volume-up volume-icon'; }
        });

        mainPlayBtn.addEventListener('click', function() {
            if (audioPlayer.paused) { audioPlayer.play(); }
            else { audioPlayer.pause(); }
        });

        playPauseBtn.addEventListener('click', function() {
            if (audioPlayer.paused) { audioPlayer.play(); }
            else { audioPlayer.pause(); }
        });

        nextTrackBtn.addEventListener('click', function() {
            if (playlistId + 1 < playlistTodayDay.length) { playlistId++; }
            updatePlayer(playlistTodayDay[playlistId]);
            audioPlayer.play();
        });

        prevTrackBtn.addEventListener('click', function() {
            if (playlistId > 0) { playlistId--; }
            updatePlayer(playlistTodayDay[playlistId]);
            audioPlayer.play();
        });

        audioPlayer.addEventListener('play', function() {
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
            document.getElementById('currentTrack')?.classList.add('playing');
        });
        
        audioPlayer.addEventListener('pause', function() {
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
            document.getElementById('currentTrack')?.classList.remove('playing');
        });

        audioPlayer.addEventListener('timeupdate', function() {
            const seconds = audioPlayer.currentTime;
            const duration = audioPlayer.duration || 0;
            const progressPercent = duration > 0 ? (seconds / duration) * 100 : 0;
            progress.style.width = `${progressPercent}%`;
            currentTimeEl.textContent = formatTime(seconds);
        });

        audioPlayer.addEventListener('loadedmetadata', function() {
            endTimeEl.textContent = formatTime(audioPlayer.duration);
        });

        audioPlayer.addEventListener('ended', function() {
            nextTrackBtn.click();
        });

        function stringToId(str, max = 4294967295) {
            let hash = 5381;
            const len = str.length;
            for (let i = 0; i < len; i++) {
                hash = ((hash << 5) + hash) ^ str.charCodeAt(i);
                hash = hash ^ (hash >>> 16);
            }
            hash = hash ^ (hash >>> 13);
            hash = hash ^ (hash << 7);
            hash = hash ^ (hash >>> 17);
            hash = hash >>> 0;
            return hash % (max + 1);;
        }

        function getOneTrack(algoritm) {
            return audiojson[Math.floor(Math.random() * audiojson.length)];
        }

        function updatePlayer(track) {
            audioPlayer.src = `audio/${track.filename}`;
            playerTitle.textContent = track.title;
            playerArtist.textContent = track.artist;
            playerCover.style = 'background: linear-gradient(135deg,' + stringToColor(track.filename) + ',' + stringToColor(track.filename + "1") + ')';
        }

        function getTodayPlaylist() {
            const playlist = [];
            for (let j = 0; j < 30; j++) {
                const track = getOneTrack();
                playlist.push(track);
            }
            return playlist;
        }

        function generateByPlaylist(playlist) {
            trackList.innerHTML = "";
            for (let i = 0; i < playlist.length; i++) {
                const track = playlist[i];
                const isLiked = false;
                const trackHTML = `<div class="track-row" data-playlistid="${i}" data-filename="${track.filename}">
                    <div class="track-info">
                        <div class="track-play-icon">
                            <i class="fas fa-play"></i>
                        </div>
                        <div class="track-cover" style="background: linear-gradient(135deg, ${stringToColor(track.filename)}, ${stringToColor(track.filename + "1")})"></div>
                        <div class="track-details">
                            <div class="track-title">${track.title}</div>
                            <div class="track-artist">${track.artist}</div>
                        </div>
                    </div>
                    <div class="track-time">
                        <div class="track-duration">${formatTime(track.duration)}</div>
                        <div class="track-like ${isLiked ? 'like-active' : ''}">
                            <i class="far fa-heart"></i>
                        </div>
                    </div>
                </div>`;
                trackList.innerHTML += trackHTML;
            }
            const allTrackRows = trackList.querySelectorAll('.track-row');
            allTrackRows.forEach(row => { row.addEventListener('click', handleTrackClick); });
        }

        function handleTrackClick(event) {
            if (event.target.closest('.track-play-icon') || event.target.classList.contains('track-play-icon')) {
                const oldPlaylistId = playlistId;
                playlistId = parseInt(event.currentTarget.dataset.playlistid);
                updatePlayer(playlistTodayDay[playlistId]);
                audioPlayer.play();
            }
        }

        let playlistId = 0;
        let playlistTodayDay = [];
        let playlistFavorite = [];
        document.addEventListener('DOMContentLoaded', function() {
            playlistTodayDay = getTodayPlaylist();
            playlistFavorite = getTodayPlaylist();
            generateByPlaylist(playlistTodayDay);
            updatePlayer(playlistTodayDay[playlistId]);
        });
    </script>
</body>
</html>
