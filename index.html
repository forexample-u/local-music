<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zilla - Local Music</title>
    <meta name="keywords" content="local music, music without internet">
    <meta name="description" content="Listen local music with HTML and modern design">
    <meta property="og:title" content="Zilla - Local Music">
    <meta property="og:description" content="Listen local music free">
    <meta property="og:image" content="images/zilla.png">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Local Music">
    <link rel="icon" href="images/zilla.png" type="image/png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" onerror="this.onerror=null;this.href='./css/fontawesome.min.css'">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: #121212;
            color: #fff;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        .sidebar {
            width: 80px;
            background-color: #000;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            color: #1db954;
            margin-bottom: 40px;
            cursor: pointer;
        }
        
        .nav-item {
            width: 100%;
            padding: 16px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .nav-item:hover {
            background-color: #1a1a1a;
        }
        
        .nav-item.active {
            background-color: #282828;
            border-left: 3px solid #1db954;
        }
        
        .nav-icon {
            font-size: 22px;
            color: #b3b3b3;
        }
        
        .nav-item.active .nav-icon {
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding-bottom: 80px;
        }
        
        .playlist-container {
            flex: 1;
            overflow-y: auto;
        }
        
        .playlist-header {
            padding: 30px;
            background: linear-gradient(180deg, #2a5d3d 0%, #121212 100%);
            display: flex;
            align-items: center;
            gap: 24px;
        }
        
        .playlist-cover {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #450af5, #c4efd9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            flex-shrink: 0;
        }
        
        .playlist-info {
            flex: 1;
        }
        
        .playlist-type {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .playlist-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 10px;
        }
        
        .playlist-description {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .playlist-stats {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #b3b3b3;
        }
        
        .playlist-actions {
            margin-top: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .play-btn {
            background-color: #1db954;
            color: #000;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .play-btn:hover {
            transform: scale(1.05);
        }
        
        .like-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 28px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .like-btn:hover {
            color: #1db954;
        }
        
        .tracks-container {
            padding: 0 30px 20px;
            background-color: #121212;
        }
        
        .track-list {
            margin-top: 20px;
        }
        
        .track-row {
            display: flex;
            align-items: center;
            padding: 12px 0 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            gap: 20px;
            min-width: 0;
        }
        
        .track-row:hover {
            background-color: #2a2a2a;
        }
        
        .track-info {
            position: relative;
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
            min-width: 0;
        }

        .track-play-icon {
            position: absolute;
            left: -5px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 20px;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1;
            width: 27px;
            height: 28px;
            padding: 14px 18px;
            box-sizing: content-box;
        }

        .track-row:hover .track-play-icon {
            opacity: 1;
        }

        .track-row:hover .track-cover {
            opacity: 0.6;
        }
        
        .track-cover {
            width: 45px;
            height: 45px;
            background-color: #333;
            flex-shrink: 0;
            border-radius: 2.5px;
        }
        
        .track-details {
            display: flex;
            flex-direction: column;
            min-width: 0;
            flex: 1;
        }
        
        .track-title {
            font-weight: 500;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .track-artist {
            color: #b3b3b3;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .track-time {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-left: auto;
            padding-right: 10px;
        }
        
        .track-duration {
            color: #b3b3b3;
            font-size: 14px;
            text-align: right;
            margin-right: 10px;
        }
        
        .track-like {
            color: #b3b3b3;
            font-size: 18px;
            transition: color 0.2s;
            cursor: pointer;
            width: 30px;
            text-align: center;
        }
        
        .track-like:hover {
            color: #1db954;
        }

        .track-dislike {
            color: #b3b3b3;
            font-size: 18px;
            transition: color 0.2s;
            cursor: pointer;
            width: 30px;
            text-align: center;
        }

        .track-dislike:hover {
            color: #ff4444;
        }

        .dislike-active {
            color: #ff4444;
        }

        .like-active {
            color: #1db954;
        }
        
        .player {
            position: fixed;
            bottom: 0;
            left: 80px;
            right: 0;
            height: 80px;
            background-color: #181818;
            border-top: 1px solid #282828;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
            flex-shrink: 0;
        }
        
        .player-track {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 300px;
        }
        
        .player-cover {
            width: 56px;
            height: 56px;
            background-color: #333;
            flex-shrink: 0;
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
        }
        
        .player-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
            cursor: pointer;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            max-height: 2.8em;
            line-height: 1.4em;
        }
        
        .player-artist {
            color: #b3b3b3;
            font-size: 12px;
            cursor: pointer;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            max-height: 1.7em;
            line-height: 1.4em;
        }
        
        .player-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            width: 65%;
        }
        
        .control-buttons {
            display: flex;
            align-items: center;
            gap: 25px;
        }
        
        .control-btn {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 18px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .control-btn:hover {
            color: #fff;
        }
        
        .play-pause-btn {
            background-color: #fff;
            color: #000;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .play-pause-btn:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            margin-top: 5px;
            margin-left: 10px;
            margin-right: 10px;
            background-color: #4d4d4d;
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress {
            transition: width 0.1s linear;
            will-change: width;
            width: 0%;
            height: 100%;
            background-color: #1db954;
        }
        
        .player-time {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 12px;
            color: #b3b3b3;
        }
        
        .player-extra {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 300px;
            justify-content: flex-end;
        }
        
        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .volume-icon {
            color: #b3b3b3;
            font-size: 18px;
        }
        
        .volume-bar {
            width: 100px;
            height: 4px;
            background-color: #4d4d4d;
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .volume-level {
            width: 70%;
            height: 100%;
            background-color: #1db954;
        }

        #audioPlayer {
            display: none;
        }

        #settingsBtn {
            position: absolute;
            bottom: 10px;
            width: 78px;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #282828;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-close {
            background: none;
            border: none;
            color: #b3b3b3;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: #fff;
        }

        .settings-label {
            display: block;
            font-size: 16px;
            color: #fff;
            margin-bottom: 10px;
        }

        .download-btn {
            background-color: #1db954;
            color: #000;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .download-btn:hover {
            transform: scale(1.05);
            background-color: #1ed760;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #121212;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #2a2a2a;
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #3a3a3a;
        }

        @media (max-width: 768px) {
            .main-content {
                padding-bottom: 70px;
                overflow-y: auto;
            }

            body {
                flex-direction: column;
                height: auto;
                min-height: 100vh;
                overflow-y: auto;
            }
            
            .sidebar {
                width: 100%;
                height: 60px;
                flex-direction: row;
                justify-content: space-around;
                padding: 0;
                top: 0;
                left: 0;
                right: 0;
                border-top: 1px solid #282828;
            }

            .tracks-container {
                padding: 0 10px 20px;
                background-color: #121212;
            }

            .player {
                left: 0px;
            }

            .player-controls {
                width: 100%;
            }

            .player-track {
                gap: 12px;
                width: 200px;
                margin-left: -5px;
            }

            .player-title {
                width: 70px;
            }

            .player-artist {
                width: 70px;
            }

            .playlist-container {
                order: 1;
            }
            
            .playlist-header {
                flex-direction: column;
                text-align: center;
                padding: 20px 15px;
                gap: 15px;
            }
            
            .playlist-cover {
                width: 150px;
                height: 150px;
                margin: 0 auto;
            }
            
            .playlist-title {
                font-size: 32px;
                line-height: 1.2;
            }
            
            .playlist-description {
                font-size: 14px;
                margin-bottom: 15px;
            }

            .playlist-actions {
                justify-content: center;
            }

            .logo {
                display: none;
            }

            .playlist-stats {
                display: none;
            }

            #playlistActionPlay {
                display: none;
            }

            .player-extra {
                display: none;
            }

            #settingsBtn {
                display: none;
            }
        }

        @media (max-width: 385px) {
            .control-buttons {
                gap: 15.5px;
            }

            .player-track {
                gap: 12px;
                margin-left: -9px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo" onclick="document.getElementById('menuHome').click(); document.querySelector('.playlist-container').scrollTo(0, 0);">
            <i class="fas fa-music"></i>
        </div>
        <div class="nav-item active" id="menuHome">
            <div class="nav-icon">
                <i class="fas fa-home"></i>
            </div>
        </div>
        <div class="nav-item" style="display: none;" id="menuSearch">
            <div class="nav-icon">
                <i class="fas fa-search"></i>
            </div>
        </div>
        <div class="nav-item" id="menuBan">
            <div class="nav-icon">
                <i class="fas fa-ban"></i>
            </div>
        </div>
        <div class="nav-item" id="menuFavorite">
            <div class="nav-icon">
                <i class="fas fa-heart"></i>
            </div>
        </div>
        <div class="nav-item" id="settingsBtn">
            <div class="nav-icon">
                <i class="fas fa-cog"></i>
            </div>
        </div>
    </div>
    <div class="main-content">
        <div class="playlist-container">
            <div class="playlist-header" id="playlistHeader">
                <div class="playlist-cover" id="playlistCover">
                    <i class="fas fa-headphones"></i>
                </div>
                <div class="playlist-info">
                    <div class="playlist-title" id="playlistTitle">Playlist Every Day</div>
                    <div class="playlist-description" id="playlistDescription" style="color: #fff">Every day belongs to you!</div>
                    <div class="playlist-stats">
                        <span>Service music</span>
                        <span>•</span>
                        <span>Playlist</span>
                        <span>•</span>
                        <span>Top</span>
                    </div>
                    <div class="playlist-actions">
                        <button class="play-btn" id="mainPlayBtn">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="like-btn" id="playlistActionPlay">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="tracks-container">
                <div class="track-list" id="trackList"></div>
            </div>
        </div>
        <div class="player">
            <audio id="audioPlayer" preload="metadata">
                <source src="" type="audio/mpeg">
            </audio>
            <div class="player-track">
                <div class="player-cover" id="playerCover" style="background: linear-gradient(135deg, #ff9a9e, #fad0c4);"></div>
                <div class="player-info">
                    <div class="player-title" id="playerTitle">None</div>
                    <div class="player-artist" id="playerArtist">None</div>
                </div>
            </div>
            <div class="player-controls">
                <div class="control-buttons">
                    <div class="track-like like-active" id="playerLike">
                        <i class="fas fa-heart"></i>
                    </div>
                    <button class="control-btn" id="prevTrackBtn">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="play-pause-btn" id="playPauseBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="control-btn" id="nextTrackBtn">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <div class="track-dislike" id="playerDislike">
                        <i class="fas fa-thumbs-down"></i>
                    </div>
                </div>
                <div class="player-time">
                    <span id="currentTimeEl">0:00</span>
                    <div class="progress-bar" id="progressBar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <span id="endTimeEl">0:00</span>
                </div>
            </div>
            <div class="player-extra">
                <div class="control-btn">
                    <i class="fas fa-list"></i>
                </div>
                <div class="volume-container">
                    <i class="fas fa-volume-up volume-icon"></i>
                    <div class="volume-bar" id="volumeBar">
                        <div class="volume-level" id="volumeLevel"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="closeModalBtn">&times;</button>
            </div>
            <button class="download-btn" id="downloadBtn">
                Download (go to local music on PC)
            </button>
        </div>
    </div>
    
    <script src="audio/audio.js"></script>
    <script src="js/jszip.min.js"></script>
    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseBtn = document.getElementById("playPauseBtn");
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const nextTrackBtn = document.getElementById("nextTrackBtn");
        const prevTrackBtn = document.getElementById("prevTrackBtn");
        const volumeBar = document.getElementById("volumeBar");
        const volumeLevel = document.getElementById("volumeLevel");
        const playerTitle = document.getElementById("playerTitle");
        const playerArtist = document.getElementById("playerArtist");
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTimeEl');
        const endTimeEl = document.getElementById('endTimeEl');
        const playerCover = document.getElementById('playerCover');
        const progressBar = document.getElementById('progressBar');
        const trackList = document.getElementById('trackList');
        const menuFavorite = document.getElementById('menuFavorite');
        const menuHome = document.getElementById('menuHome');
        const menuBan = document.getElementById('menuBan');
        const menuSearch = document.getElementById('menuSearch');
        const playlistHeader = document.getElementById('playlistHeader');
        const playlistTitle = document.getElementById('playlistTitle');
        const playlistDescription = document.getElementById('playlistDescription');
        const playlistCover = document.getElementById('playlistCover');
        const playerLike = document.getElementById('playerLike');
        const playerDislike = document.getElementById('playerDislike');
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsModal = document.getElementById('settingsModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        
        const jpgImageFolder = "audio";
        let playlistId = 0;
        let favoritePlaylist = [];
        let dislikePlaylist = [];
        let todayPlaylist = [];
        let currentPlaylist = [];
        let currentPage = "today";
        let avatarNotFound = [];
        let isUpdateCurrentPlaylist = false;
        
        function formatTime(seconds){
            const secs = Math.floor(seconds % 60);
            return `${Math.floor(seconds / 60)}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function stringToColor(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = str.charCodeAt(i) + ((hash << 5) - hash);
            }
            const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();
            return "#" + "00000".substring(0, 6 - c.length) + c;
        }

        settingsBtn.addEventListener('click', function() {
            settingsModal.style.display = 'flex';
        });

        closeModalBtn.addEventListener('click', function() {
            settingsModal.style.display = 'none';
        });

        downloadBtn.addEventListener('click', async function() {
            downloadBtn.innerHTML = "Start download...";
            const fileurl = jpgImageFolder.replace('.', '').replace("/", '') + "/";
            const zip = new JSZip();
            const jsFolder = zip.folder("js");
            const cssFolder = zip.folder("css");
            const audioFolder = zip.folder("audio");
            const imagesFolders = zip.folder("images");
            const webfontsFolders = zip.folder("webfonts");
            for (let i = 0; i < audiojson.length; i++) {
                try {
                    const audioResponse = await fetch(fileurl + audiojson[i].filename);
                    if (audioResponse.ok) {
                        audioFolder.file(audiojson[i].filename, await audioResponse.blob());
                    }
                    downloadBtn.innerHTML = "File download: " + i + " / " + audiojson.length;
                } catch (error) {
                    console.warn(`Error fetch ${fileurl + audiojson[i].filename}:`, error);
                }
                try {
                    const filenamejpg = audiojson[i].filename.split('.').slice(0, -1).join('.') + ".jpg";
                    const jpgResponse = await fetch(fileurl + filenamejpg);
                    if (jpgResponse.ok) {
                        audioFolder.file(filenamejpg, await jpgResponse.blob());
                    }
                } catch {}
            }
            const filesToDownload = [
                { url: 'index.html', folder: null, name: 'index.html' },
                { url: 'add.html', folder: null, name: 'add.html' },
                { url: 'audio/audio.js', folder: audioFolder, name: 'audio.js' },
                { url: 'js/jszip.min.js', folder: jsFolder, name: 'jszip.min.js' },
                { url: 'js/jsmediatags.min.js', folder: jsFolder, name: 'jsmediatags.min.js' },
                { url: 'css/fontawesome.min.css', folder: cssFolder, name: 'fontawesome.min.css' },
                { url: 'images/zilla.png', folder: imagesFolders, name: 'zilla.png' },
                { url: 'webfonts/fa-brands-400.woff2', folder: webfontsFolders, name: 'fa-brands-400.woff2' },
                { url: 'webfonts/fa-regular-400.woff2', folder: webfontsFolders, name: 'fa-regular-400.woff2' },
                { url: 'webfonts/fa-solid-900.woff2', folder: webfontsFolders, name: 'fa-solid-900.woff2' },
                { url: 'webfonts/fa-v4compatibility.woff2', folder: webfontsFolders, name: 'fa-v4compatibility.woff2' }
            ];
            downloadBtn.innerHTML = "File audio.zip download!";
            for (const file of filesToDownload) {
                try {
                    const response = await fetch(file.url);
                    if (response.ok) {
                        const blob = await response.blob();
                        if (file.folder) { file.folder.file(file.name, blob); }
                        else { zip.file(file.name, blob); }
                    }
                } catch (error) {
                    console.warn(`Error fetch ${file.url}:`, error);
                }
            }
            const zipBlob = await zip.generateAsync({type: "blob"});
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(zipBlob);
            downloadLink.download = 'audio_files.zip';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(downloadLink.href);
        });

        progressBar.addEventListener('click', function(e) {
            const clickPosition = e.offsetX;
            const progressBarWidth = this.offsetWidth;
            const duration = audioPlayer.duration;
            if (duration && !isNaN(duration)) {
                audioPlayer.currentTime = (clickPosition / progressBarWidth) * duration;
                progress.style.width = `${(clickPosition / progressBarWidth) * 100}%`;
            }
        });

        menuHome.addEventListener('auxclick', function(e) { e.preventDefault(); window.open(window.location.href, '_blank'); });
        menuFavorite.addEventListener('auxclick', function(e) { e.preventDefault(); window.open(window.location.href, '_blank'); });
        menuSearch.addEventListener('auxclick', function(e) { e.preventDefault(); window.open(window.location.href, '_blank'); });
        menuBan.addEventListener('auxclick', function(e) { e.preventDefault(); window.open(window.location.href, '_blank'); });

        menuHome.addEventListener('click', function() {
            menuHome.classList.add('active');
            menuFavorite.classList.remove('active');
            menuBan.classList.remove('active');
            menuSearch.classList.remove('active');
            generateTodayPlaylist();
            currentPage = "today";
            try {
                history.pushState({page: currentPage}, '', window.location.pathname);
            } catch {
                history.pushState({page: currentPage}, '', `?page=${currentPage}`);
            }
            document.querySelector('.playlist-container').scrollTo({ top: 0, behavior: 'smooth' });
            isUpdateCurrentPlaylist = true;
        });

        menuFavorite.addEventListener('click', function() {
            menuFavorite.classList.add('active');
            menuHome.classList.remove('active');
            menuBan.classList.remove('active');
            menuSearch.classList.remove('active');
            generateFavoritePlaylist();
            currentPage = "favorite";
            history.pushState({page: currentPage}, '', `?page=${currentPage}`);
            document.querySelector('.playlist-container').scrollTo({ top: 0, behavior: 'smooth' });
            isUpdateCurrentPlaylist = true;
        });

        menuSearch.addEventListener('click', function() {
            menuSearch.classList.add('active');
            menuHome.classList.remove('active');
            menuFavorite.classList.remove('active');
            menuBan.classList.remove('active');
            isUpdateCurrentPlaylist = true;
        });

        menuBan.addEventListener('click', function() {
            menuBan.classList.add('active');
            menuHome.classList.remove('active');
            menuFavorite.classList.remove('active');
            menuSearch.classList.remove('active');
            generateDislikePlaylist();
            currentPage = "dislike";
            history.pushState({page: currentPage}, '', `?page=${currentPage}`);
            document.querySelector('.playlist-container').scrollTo({ top: 0, behavior: 'smooth' });
            isUpdateCurrentPlaylist = true;
        });

        volumeBar.addEventListener('click', function(e) {
            const newVolume = e.offsetX / this.offsetWidth;
            audioPlayer.volume = newVolume;
            volumeLevel.style.width = `${newVolume * 100}%`;
            const volumeIcon = document.querySelector('.volume-icon');
            if (newVolume === 0) { volumeIcon.className = 'fas fa-volume-mute volume-icon'; }
            else { volumeIcon.className = 'fas fa-volume-up volume-icon'; }
            localStorage.setItem('playerVolume', newVolume.toString());
        });

        mainPlayBtn.addEventListener('click', function() {
            if (audioPlayer.paused) {
                const lastPlaylistLength = currentPlaylist.length;
                if (currentPage == "today") { currentPlaylist = Array.from(todayPlaylist); }
                if (currentPage == "dislike") { currentPlaylist = Array.from(dislikePlaylist); }
                if (currentPage == "favorite") { currentPlaylist = Array.from(favoritePlaylist); }
                if (currentPlaylist.length > 0 && currentPlaylist.length != lastPlaylistLength) { // be carefull this work but if lastPlaylistLength other
                    playlistId = 0;
                    updatePlayer(currentPlaylist[playlistId]);
                }
                audioPlayer.play();
            }
            else { 
                audioPlayer.pause();
            }
        });

        playPauseBtn.addEventListener('click', function(e) {
            e.preventDefault();
            if (audioPlayer.paused) { audioPlayer.play(); }
            else { audioPlayer.pause(); }
        });

        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA' && !e.target.isContentEditable) {
                e.preventDefault();
                if (audioPlayer.paused) { audioPlayer.play(); }
                else { audioPlayer.pause(); }
            }
        });

        nextTrackBtn.addEventListener('click', function() {
            if (playlistId + 1 < currentPlaylist.length) { playlistId++; }
            updatePlayer(currentPlaylist[playlistId]);
            audioPlayer.play();
        });

        prevTrackBtn.addEventListener('click', function() {
            if (playlistId > 0) { playlistId--; }
            updatePlayer(currentPlaylist[playlistId]);
            audioPlayer.play();
        });

        playerLike.addEventListener('click', function() {
            const currentTrack = currentPlaylist[playlistId];
            if (currentTrack) {
                const isLiked = toggleFavorite(currentTrack.filename);
                if (isLiked) {
                    playerLike.classList.add('like-active');
                    playerLike.innerHTML = '<i class="fas fa-heart"></i>';
                    if (playerDislike.classList.contains('dislike-active')) {
                        playerDislike.classList.remove('dislike-active');
                        playerDislike.innerHTML = '<i class="far fa-thumbs-down"></i>';
                    }
                } else {
                    playerLike.classList.remove('like-active');
                    playerLike.innerHTML = '<i class="far fa-heart"></i>';
                }
                const trackRow = document.querySelector(`[data-filename="${currentTrack.filename}"]`);
                if (trackRow) {
                    const likeBtn = trackRow.querySelector('.track-like');
                    const dislikeBtn = trackRow.querySelector('.track-dislike');
                    if (likeBtn) {
                        if (isLiked) {
                            likeBtn.classList.add('like-active');
                            likeBtn.innerHTML = '<i class="fas fa-heart"></i>';
                            if (dislikeBtn && dislikeBtn.classList.contains('dislike-active')) {
                                dislikeBtn.classList.remove('dislike-active');
                                dislikeBtn.innerHTML = '<i class="far fa-thumbs-down"></i>';
                            }
                            trackRow.style.opacity = '1';
                        } else {
                            likeBtn.classList.remove('like-active');
                            likeBtn.innerHTML = '<i class="far fa-heart"></i>';
                        }
                    }
                }
            }
        });

        playerDislike.addEventListener('click', function() {
            const currentTrack = currentPlaylist[playlistId];
            if (currentTrack) {
                const isDisliked = toggleDislike(currentTrack.filename);
                if (!isDisliked) {
                    playerDislike.classList.remove('dislike-active');
                    playerDislike.innerHTML = '<i class="far fa-thumbs-down"></i>';
                }
                const trackRow = document.querySelector(`[data-filename="${currentTrack.filename}"]`);
                if (trackRow) {
                    const likeBtn = trackRow.querySelector('.track-like');
                    const dislikeBtn = trackRow.querySelector('.track-dislike');
                    if (dislikeBtn) {
                        if (isDisliked) {
                            dislikeBtn.classList.add('dislike-active');
                            dislikeBtn.innerHTML = '<i class="fas fa-thumbs-down"></i>';
                            if (likeBtn && likeBtn.classList.contains('like-active')) {
                                likeBtn.classList.remove('like-active');
                                likeBtn.innerHTML = '<i class="far fa-heart"></i>';
                            }
                            trackRow.style.opacity = '0.7';
                        } else {
                            dislikeBtn.classList.remove('dislike-active');
                            dislikeBtn.innerHTML = '<i class="far fa-thumbs-down"></i>';
                            trackRow.style.opacity = '1';
                        }
                    }
                }
            }
        });

        audioPlayer.addEventListener('play', function() {
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
        });
        
        audioPlayer.addEventListener('pause', function() {
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        });

        audioPlayer.addEventListener('timeupdate', function() {
            const seconds = audioPlayer.currentTime;
            const duration = audioPlayer.duration || 0;
            const progressPercent = duration > 0 ? (seconds / duration) * 100 : 0;
            progress.style.width = `${progressPercent}%`;
            currentTimeEl.textContent = formatTime(seconds);
        });

        audioPlayer.addEventListener('loadedmetadata', function() {
            endTimeEl.textContent = formatTime(audioPlayer.duration);
        });

        audioPlayer.addEventListener('ended', function() {
            nextTrackBtn.click();
        });

        function toggleFavorite(filename) {
            const favoriteFilenames = favoritePlaylist.map(track => track.filename);
            const dislikeFilenames = dislikePlaylist.map(track => track.filename);
            const favoriteIndex = favoriteFilenames.indexOf(filename);
            const dislikeIndex = dislikeFilenames.indexOf(filename);
            if (favoriteIndex === -1) {
                const track = audiojson.find(track => track.filename === filename);
                if (track) {
                    favoritePlaylist.unshift(track);
                    favoriteFilenames.unshift(filename);
                    if (dislikeIndex !== -1) {
                        dislikePlaylist.splice(dislikeIndex, 1);
                        dislikeFilenames.splice(dislikeIndex, 1);
                    }
                }
            } else {
                favoritePlaylist.splice(favoriteIndex, 1);
                favoriteFilenames.splice(favoriteIndex, 1);
            }
            localStorage.setItem('favoritePlaylist', JSON.stringify(favoriteFilenames));
            localStorage.setItem('dislikePlaylist', JSON.stringify(dislikeFilenames));
            return favoriteIndex === -1;
        }

        function toggleDislike(filename) {
            const favoriteFilenames = favoritePlaylist.map(track => track.filename);
            const dislikeFilenames = dislikePlaylist.map(track => track.filename);
            const favoriteIndex = favoriteFilenames.indexOf(filename);
            const dislikeIndex = dislikeFilenames.indexOf(filename);
            if (dislikeIndex === -1) {
                const track = audiojson.find(track => track.filename === filename);
                if (track) {
                    dislikePlaylist.unshift(track);
                    dislikeFilenames.unshift(filename);
                    const todayIndex = todayPlaylist.findIndex(track => track.filename === filename);
                    if (currentPlaylist[playlistId] && currentPlaylist[playlistId].filename === filename) {
                        nextTrackBtn.click();
                    }
                    if (todayIndex !== -1) {
                        todayPlaylist.splice(todayIndex, 1);
                        localStorage.setItem('dailyPlaylist', JSON.stringify(todayPlaylist.map(track => track.filename)));
                    }
                    if (favoriteIndex !== -1) {
                        favoritePlaylist.splice(favoriteIndex, 1);
                        favoriteFilenames.splice(favoriteIndex, 1);
                    }
                }
            } else {
                dislikePlaylist.splice(dislikeIndex, 1);
                dislikeFilenames.splice(dislikeIndex, 1);
            }
            localStorage.setItem('favoritePlaylist', JSON.stringify(favoriteFilenames));
            localStorage.setItem('dislikePlaylist', JSON.stringify(dislikeFilenames));
            return dislikeIndex === -1;
        }

        function setCoverBackground(coverElement, track) {
            if (track.filename.length % 2 == 0) {
                const color1 = stringToColor(track.artist);
                const color2 = stringToColor(track.title);
                const color3 = stringToColor(track.artist + track.title);
                coverElement.style.background = `radial-gradient(circle at 30% 20%, ${color1}40, transparent 40%),
                    radial-gradient(circle at 70% 80%, ${color2}30, transparent 30%),
                    linear-gradient(135deg, ${color1}20, ${color3}40, ${color2}20)`;
                coverElement.style.backgroundSize = 'cover, cover, cover';
                coverElement.style.backgroundBlendMode = 'screen';
            } else {
                coverElement.style.background = 'linear-gradient(135deg,' + stringToColor(track.filename) + ',' + stringToColor(track.filename + "1") + ')';
                coverElement.style.backgroundSize = 'cover';
                coverElement.style.backgroundPosition = 'center';
            }
        }

        function updatePlayer(track) {
            if (!audioPlayer.src.endsWith(`${track.filename}`)) {
                audioPlayer.src = `audio/${track.filename}`;
            }
            playerTitle.textContent = track.title;
            playerArtist.textContent = track.artist;
            const isLiked = favoritePlaylist.some(t => t.filename === track.filename);
            const isDisliked = dislikePlaylist.some(t => t.filename === track.filename);
            if (isDisliked) {
                playerLike.classList.remove('like-active');
                playerLike.innerHTML = '<i class="far fa-heart"></i>';
                playerDislike.classList.add('dislike-active');
                playerDislike.innerHTML = '<i class="fas fa-thumbs-down"></i>';
            } else if (isLiked) {
                playerDislike.classList.remove('dislike-active');
                playerDislike.innerHTML = '<i class="far fa-thumbs-down"></i>';
                playerLike.classList.add('like-active');
                playerLike.innerHTML = '<i class="fas fa-heart"></i>';
            } else {
                playerLike.classList.remove('like-active');
                playerLike.innerHTML = '<i class="far fa-heart"></i>';
                playerDislike.classList.remove('dislike-active');
                playerDislike.innerHTML = '<i class="far fa-thumbs-down"></i>';
            }
            const imagePath = jpgImageFolder + `/${track.filename.split('.').slice(0, -1).join('.') + '.jpg'}`;
            const testImage = new Image();
            if (avatarNotFound.includes(track.filename)){
                setCoverBackground(playerCover, track);
            } else {
                testImage.onload = function() {
                    playerCover.style.background = `url('${imagePath}')`;
                    playerCover.style.backgroundSize = 'cover';
                    playerCover.style.backgroundPosition = 'center';
                    playerCover.style.backgroundBlendMode = 'overlay';
                };
                testImage.onerror = function() {
                    setCoverBackground(playerCover, track);
                    avatarNotFound.push(track.filename);
                };
                testImage.src = imagePath;
            }
            localStorage.setItem("track", JSON.stringify(track));
        }

        function getTodayPlaylist() {
            const playlist = [];
            for (let j = 0; j < 55; j++) {
                let track = null;
                track = audiojson[Math.floor(Math.random() * audiojson.length)];
                if (!dislikePlaylist.includes(track) && !playlist.includes(track)) {
                    playlist.push(track);
                } else if (Math.random() > 0.9) {
                    j -= 1;
                }
            }
            return playlist;
        }

        function generateHtmlByPlaylist(playlistTracks) {
            if (playlistTracks.length > 0) { trackList.innerHTML = ""; }
            for (let i = 0; i < playlistTracks.length; i++) {
                const track = playlistTracks[i];
                const isLiked = favoritePlaylist.includes(track);
                const isDisliked = dislikePlaylist.includes(track);
                const trackElement = document.createElement("div");
                const trackInfo = document.createElement("div");
                const playIcon = document.createElement("div");
                const cover = document.createElement("div");
                trackElement.className = "track-row";
                trackElement.id = (playlistId === i ? 'currentTrack' : '');
                trackElement.dataset.playlistid = i;
                trackElement.dataset.filename = track.filename;
                if (isDisliked) { trackElement.style.opacity = '0.7'; }
                trackInfo.className = "track-info";
                playIcon.className = "track-play-icon";
                playIcon.innerHTML = '<i class="fas fa-play"></i>';
                cover.className = "track-cover";
                const imagePath = jpgImageFolder + `/${track.filename.split('.').slice(0, -1).join('.') + '.jpg'}`;
                const testImage = new Image();
                if (avatarNotFound.includes(track.filename)){
                    setCoverBackground(cover, track);
                } else {
                    testImage.onload = function() {
                        cover.style.background = `url('${imagePath}')`;
                        cover.style.backgroundSize = 'cover';
                        cover.style.backgroundPosition = 'center';
                        cover.style.backgroundBlendMode = 'overlay';
                    };
                    testImage.onerror = function() {
                        setCoverBackground(cover, track);
                        avatarNotFound.push(track.filename);
                    };
                    testImage.src = imagePath;
                }
                const trackDetails = document.createElement("div");
                const trackTitle = document.createElement("div");
                const trackArtist = document.createElement("div");
                trackDetails.className = "track-details";
                trackTitle.className = "track-title";
                trackArtist.className = "track-artist";
                trackTitle.textContent = track.title;
                trackArtist.textContent = track.artist;
                trackDetails.appendChild(trackTitle);
                trackDetails.appendChild(trackArtist);
                trackInfo.appendChild(playIcon);
                trackInfo.appendChild(cover);
                trackInfo.appendChild(trackDetails);
                const trackTime = document.createElement("div");
                const trackDuration = document.createElement("div");
                const likeButton = document.createElement("div");
                const dislikeButton = document.createElement("div");
                trackTime.className = "track-time";
                trackDuration.className = "track-duration";
                trackDuration.textContent = formatTime(track.duration);
                likeButton.className = `track-like ${isLiked ? 'like-active' : ''}`;
                likeButton.dataset.filename = track.filename;
                likeButton.innerHTML = `<i class="${isLiked ? 'fas' : 'far'} fa-heart"></i>`;
                dislikeButton.className = `track-dislike ${isDisliked ? 'dislike-active' : ''}`;
                dislikeButton.dataset.filename = track.filename;
                dislikeButton.innerHTML = `<i class="${isDisliked ? 'fas' : 'far'} fa-thumbs-down"></i>`;
                trackTime.appendChild(likeButton);
                trackTime.appendChild(dislikeButton);
                trackTime.appendChild(trackDuration);
                trackElement.appendChild(trackInfo);
                trackElement.appendChild(trackTime);
                trackList.appendChild(trackElement);
            }
            // add like/dislike work:
            const allTrackRows = trackList.querySelectorAll('.track-row');
            const allLikeButtons = trackList.querySelectorAll('.track-like');
            const allDislikeButtons = trackList.querySelectorAll('.track-dislike');
            allTrackRows.forEach(row => { 
                row.addEventListener('click', function(e) {
                    if (e.target.closest('.track-play-icon') || e.target.classList.contains('track-play-icon')) {
                        e.currentTarget.id = 'currentTrack';
                        if (currentPage == "today" && isUpdateCurrentPlaylist) { currentPlaylist = Array.from(todayPlaylist); isUpdateCurrentPlaylist = false; }
                        if (currentPage == "dislike" && isUpdateCurrentPlaylist) { currentPlaylist = Array.from(dislikePlaylist); isUpdateCurrentPlaylist = false; }
                        if (currentPage == "favorite" && isUpdateCurrentPlaylist) { currentPlaylist = Array.from(favoritePlaylist); isUpdateCurrentPlaylist = false; }
                        if (currentPlaylist[playlistId] && currentPlaylist[playlistId].filename === e.currentTarget.dataset.filename) {
                            updatePlayer(currentPlaylist[playlistId]);
                            if (audioPlayer.paused) { audioPlayer.play(); }
                            else { audioPlayer.pause(); }
                        } else {
                            playlistId = parseInt(e.currentTarget.dataset.playlistid);
                            updatePlayer(currentPlaylist[playlistId]);
                            audioPlayer.play();
                        }
                    }
                }); 
            });
            allLikeButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const filename = this.dataset.filename;
                    const liked = toggleFavorite(filename);
                    if (liked) {
                        this.classList.add('like-active');
                        this.innerHTML = '<i class="fas fa-heart"></i>';
                    } else {
                        this.classList.remove('like-active');
                        this.innerHTML = '<i class="far fa-heart"></i>';
                    }
                    const row = this.closest('.track-row');
                    const dislikeBtn = row.querySelector('.track-dislike');
                    if (dislikeBtn) {
                        dislikeBtn.classList.remove('dislike-active');
                        dislikeBtn.innerHTML = '<i class="far fa-thumbs-down"></i>';
                    }
                    const currentTrack = currentPlaylist[playlistId];
                    if (currentTrack && currentTrack.filename === filename) {
                        if (liked) {
                            playerLike.classList.add('like-active');
                            playerLike.innerHTML = '<i class="fas fa-heart"></i>';
                            playerDislike.classList.remove('dislike-active');
                            playerDislike.innerHTML = '<i class="far fa-thumbs-down"></i>';
                        } else {
                            playerLike.classList.remove('like-active');
                            playerLike.innerHTML = '<i class="far fa-heart"></i>';
                        }
                    }
                });
            });
            allDislikeButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const filename = this.dataset.filename;
                    const disliked = toggleDislike(filename);
                    const row = this.closest('.track-row');
                    if (disliked) {
                        this.classList.add('dislike-active');
                        this.innerHTML = '<i class="fas fa-thumbs-down"></i>';
                        row.style.opacity = '0.7';
                    } else {
                        this.classList.remove('dislike-active');
                        this.innerHTML = '<i class="far fa-thumbs-down"></i>';
                        row.style.opacity = '1';
                    }
                    const likeBtn = row.querySelector('.track-like');
                    if (likeBtn) {
                        likeBtn.classList.remove('like-active');
                        likeBtn.innerHTML = '<i class="far fa-heart"></i>';
                    }
                });
            });
        }

        function generateFavoritePlaylist() {
            playlistDescription.innerHTML = "Your favorite track";
            playlistHeader.style.background = "linear-gradient(180deg, #4c192c 0%, #121212 100%)";
            playlistTitle.innerHTML = "Favorite";
            playlistCover.style.background = "linear-gradient(135deg, #e94057, #8a2387, #f27121)";
            playlistCover.innerHTML = '<i class="fas fa-heart"></i>';
            if (favoritePlaylist.length === 0) {
                trackList.innerHTML = '<div style="padding: 40px; text-align: center; color: #b3b3b3;">No favorite tracks yet</div>';
                return;
            }
            generateHtmlByPlaylist(favoritePlaylist);
        }

        function generateTodayPlaylist() {
            playlistDescription.innerHTML = "Every day belongs to you!";
            playlistHeader.style.background = "linear-gradient(180deg, #2a5d3d 0%, #121212 100%)";
            playlistTitle.innerHTML = "Playlist Every Day";
            playlistCover.style.background = "";
            playlistCover.innerHTML = '<i class="fas fa-headphones"></i>';
            if (todayPlaylist.length === 0) {
                trackList.innerHTML = '<div style="padding: 40px; text-align: center; color: #b3b3b3;">Music not found</div>';
                return;
            }
            generateHtmlByPlaylist(todayPlaylist);
        }

        function generateDislikePlaylist() {
            playlistDescription.innerHTML = "Damm this track like shit!";
            playlistHeader.style.background = "linear-gradient(180deg, #170000 0%, #121212 100%)";
            playlistTitle.innerHTML = "Block Track";
            playlistCover.style.background = "linear-gradient(135deg, #b0b0b0, #707070, #3a3a3a)";
            playlistCover.innerHTML = '<i class="fas fa-ban"></i>';
            if (dislikePlaylist.length === 0) {
                trackList.innerHTML = '<div style="padding: 40px; text-align: center; color: #b3b3b3;">No dislike tracks yet</div>';
                return;
            }
            generateHtmlByPlaylist(dislikePlaylist);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // for test generate algorithm playlist:
            // localStorage.removeItem("nextTodayPlaylistDate");
            const favorite = JSON.parse(localStorage.getItem('favoritePlaylist')) || [];
            for (let i = 0; i < favorite.length; i++) {
                for (let j = 0; j < audiojson.length; j++) {
                    if (favorite[i] == audiojson[j].filename) {
                        favoritePlaylist.push(audiojson[j]);
                    }
                }
            }
            const dislike = JSON.parse(localStorage.getItem('dislikePlaylist')) || [];
            for (let i = 0; i < dislike.length; i++) {
                for (let j = 0; j < audiojson.length; j++) {
                    if (dislike[i] == audiojson[j].filename) {
                        dislikePlaylist.push(audiojson[j]);
                    }
                }
            }
            let nextTodayPlaylistDate = localStorage.getItem('nextTodayPlaylistDate');
            if (nextTodayPlaylistDate === null || new Date() >= new Date(nextTodayPlaylistDate)) {
                nextTodayPlaylistDate = new Date();
                nextTodayPlaylistDate.setDate(nextTodayPlaylistDate.getDate() + 1);
                nextTodayPlaylistDate.setHours(4, 0, 0, 0);
                todayPlaylist = getTodayPlaylist();
                if (todayPlaylist.length > 0) {
                    localStorage.setItem('nextTodayPlaylistDate', nextTodayPlaylistDate.toISOString());
                    localStorage.setItem('dailyPlaylist', JSON.stringify(todayPlaylist.map(track => track.filename)));
                }
            } else {
                const daily = JSON.parse(localStorage.getItem('dailyPlaylist')) || [];
                for (let i = 0; i < daily.length; i++) {
                    for (let j = 0; j < audiojson.length; j++) {
                        if (daily[i] == audiojson[j].filename) {
                            todayPlaylist.push(audiojson[j]);
                        }
                    }
                }
                if (daily.length == 0) { localStorage.removeItem("nextTodayPlaylistDate"); }
            }
            if (todayPlaylist.length == 0) {
                nextTodayPlaylistDate = new Date();
                nextTodayPlaylistDate.setDate(nextTodayPlaylistDate.getDate() + 1);
                nextTodayPlaylistDate.setHours(4, 0, 0, 0);
                todayPlaylist = getTodayPlaylist();
                if (todayPlaylist.length > 0) {
                    localStorage.setItem('nextTodayPlaylistDate', nextTodayPlaylistDate.toISOString());
                    localStorage.setItem('dailyPlaylist', JSON.stringify(todayPlaylist.map(track => track.filename)));
                }
            }
            currentPage = new URLSearchParams(window.location.search).get('page');
            if (currentPage == "favorite") {
                currentPlaylist = Array.from(favoritePlaylist);
                generateFavoritePlaylist();
                menuHome.classList.remove('active');
                menuFavorite.classList.add('active');
            }
            else if (currentPage == "dislike") {
                currentPlaylist = Array.from(dislikePlaylist);
                generateDislikePlaylist();
                menuHome.classList.remove('active');
                menuBan.classList.add('active');
            }
            else {
                currentPage = "today";
                currentPlaylist = Array.from(todayPlaylist);
                generateTodayPlaylist();
            }
            const savedVolume = localStorage.getItem('playerVolume');
            if (savedVolume !== null) {
                const volume = parseFloat(savedVolume);
                audioPlayer.volume = volume;
                volumeLevel.style.width = `${volume * 100}%`;
                const volumeIcon = document.querySelector('.volume-icon');
                if (volume === 0) { volumeIcon.className = 'fas fa-volume-mute volume-icon'; }
                else { volumeIcon.className = 'fas fa-volume-up volume-icon'; }
            }
            if (currentPlaylist[playlistId]) {
                updatePlayer(currentPlaylist[playlistId]);
            }
        });
    </script>
</body>
</html>

